# CreateRouteList
Автоматическое создание маршрутных листов по шаблонам на месяц

Исходный код программы находится в файле main.py
Код скомпилирован в запускаемый файл Создание путёвок за месяц.exe
1.	Все необходимые файлы, папки и программа находятся в архиве route_list.7z. Копируем этот файл в отдельную папку и разархивируем содержимое архива в текущую папку. 
2.	Содержимое архива:
2.1.	Папка Исходные данные – папка в которой находятся данные, которые загружаются для работы программы. В эту же папку помещается табель за месяц, для которого необходимо создать путевые листы. Описание назначения всех файлов в п.3 инструкции.
2.2.	Папка маршруты – в этой папки находятся стандартные шаблоны маршрутов, которые подставляются случайным образом для заполнения путевых листов водителей. Как правило маршруты создаются один раз и не требуют корректировок. Если корректировка маршрутов всё-таки потребуется, то важно не менять (добавлять, удалять) колонки, строки и менять расположения данных в этих маршрутах. Можно менять данные только в ячейках, выделенных желтым цветом. Сами данные в ячейках можно корректировать как это требуется для составления путевых листов. Шаблонов маршрутов можно создавать сколько угодно, чем больше, тем больше вероятности разнообразия путевых листов. Наименование файла должно соответствовать следующему числу, идущему по порядку, т.к. шаблоны берутся случайным образом из диапазона чисел соответствующих числу файлов в папке.
2.3.	 Создание путёвок за месяц.exe – программа для создания путевых листов.
3.	Содержимое папки Исходные данные.
3.1.	 автомобили.xlsx – файл, в котором содержатся данные автомобилей. В этом файле нельзя менять наименование и расположения колонок. В этом файле можно при необходимости менять любые данные в таблице. В колонке Табельный номер прописываются табельные номера водителей, которые работают на автомобиле указанных в строке таблицы.
Как в этом файле будут прописаны данные по автомобилям, так они и будут подставляться в автоматически создаваемые путевые листы (заглавные буквы, пробелы, названия, расход, номер автомобиля и т.п.). Все эти данные можно менять перед запуском программы. 
Важно:
- чтобы, табельные номера в табеле, совпадали со значением табельных номеров прописанных к автомобилям в этом файле;
- показания одометра по автомобилям совпадали с показаниями одометра на конец предыдущего месяца;
- расход топлива лето и зима соответствовал данным из приказа по принятым нормам расхода топлива.
 
3.2.	 водители.xlsx – файл, в котором содержатся данные водителей. В этом файле нельзя менять наименование и расположения колонок. Водителей в списке может быть любое количество. Важно заполнять все колонки по каждому водителю. При работе, программа проверяет, чтобы срок действия прав не заканчивался в месяц, за который оформляются путевые листы. В противном случае программа выдаст сообщения об окончании срока действия прав и выдаст сообщения о списке водителей у которых срок действия закончился и завершит свою работу. Необходимо внести в файл новое водительское удостоверение этого сотрудника и заново запустить программу.
Как в этом файле будут прописаны данные по водителям, так они и будут подставляться в автоматически создаваемые путевые листы (заглавные буквы, пробелы, в колонках Водитель и Права). Все эти данные можно менять перед запуском программы.
Важно:
- чтобы, табельные номера в графике работы совпадали со значением табельных номеров прописанных к водителям в этом файле;
- прописаны сроки действия водительских удостоверений.
 
3.3.	Шаблон расчета фактического расхода топлива по машинам.xlsx – файл шаблон, который используется для заполнения итогового файла за месяц. В этом файле можно изменять данные по организации, данные о приказе (номер, дата и т.п.), ФИО руководителя и бухгалтера. При этом менять можно значения в ячейках. Нельзя менять объединение, и расположения данных, даже если они не отображаются в файле шаблона.
4.	Алгоритм работы по работе с путевыми листами
4.1.	Выставления счетов на следующий квартал
После составления путевых листов и списания топлива за предыдущий квартал проверяем остаток на складе топлива в литрах. Для это в 1С БП формируем Оборотно-сальдовая ведомость по счету 10.03.
 
Берём количество рабочих дней в следующем квартале и умножаем их на количество машин и на максимальный расход по маршруту. На момент составления инструкции это 4 машины и максимальный расход 6 литров.
От получившегося значения отнимаем остаток топлива на конец предыдущего квартал и получаем ориентировочное количество литров, на которое необходимо выставить счёт.
Пример:
Согласно производственного календаря в 3-ем квартале 2021 года 63 рабочих дня. Остаток топлива на конец предыдущего 2-го квартала составляет 879 литров.
Ориентировочное количество литров на 3-ий квартал рассчитывается по формуле 63 * 4 * 6 - 879 = 633 литра. Т.е. документы можно выставлять на 650 литров.
После получения документов, оприходуем топливо на склад и оплачиваем счёт.
4.2.	После окончания каждого месяца формируем в 1С ЗУП табель за отработанный месяц. Выбираем количество сотрудников согласно количества машин, с наибольшим количеством рабочих дней, в наименовании должности которых есть слово водитель и по которым мы можем получить данные водительских удостоверений. 1С ЗУП, раздел Зарплата – Отчеты по зарплате – Табель учета рабочего времени (Т-13)
Выбираем требуемый месяц, сотрудников и организацию.
 
Количество выбранных сотрудников должно совпадать с количеством автомобилей в файле автомобили.xlsx.
Нажимаем Закрыть и сформировать.
Полученный табель сохраняем в папку Исходные данные. Важно: 
- наименование файла обязательно должно заканчиваться …табель.xlsx;
-в папке Исходные данные должен быть только один файл с наименованием …табель.xlsx. Если у Вас программа запускается не в первый раз, и в папке уже есть файл с наименованием …табель.xlsx, то его обязательно надо удалить перед сохранением нового табеля.
 

4.3.	Проверяем что по всем водителям, из сохранённого табеля, есть данные и их табельные номера в файле водители.xlsx и что табельные номера сотрудников из табеля прописаны в файле автомобили.xlsx. Если данных нет, то вносим корректировки в эти файлы перед запуском программы.
4.4.	Запускаем исполняемый файл Создание путёвок за месяц.exe двойным нажатием на него.
4.5.	В результате работы программы в папке с исполняемым файлом создаётся итоговый файл за месяц [год.месяц] Расчет фактического расхода топлива по машинам.xlsx
Распечатываем этот файл, на основании его данных создаём документы расхода топлива в 1С и подшиваем в архив.
5.	Результат работы программы.
В результате работы программа создаёт папки с наименованием сотрудников из табеля. Внутри папок сотрудников создаёт папку за месяц табеля, который используется для работы программы [год.месяц]. В эти папки сохраняются заполненные путевые листы со случайным образом выбранными маршрутами.
В папке Исходные данные пересохраняется файл автомобили.xlsx с новыми данными показания одометра по каждой машине по окончанию работы программы.
Создаётся файл автомобили_до работы программы.xlsx с предыдущими данными из файла автомобили.xlsx для того, чтобы можно было откатить данные на начало месяца в случае обнаружения ошибок. Если требуется откатить данные, то удаляем файл автомобили.xlsx и изменяем наименования файла автомобили_до работы программы.xlsx на автомобили.xlsx.
В корневой папке, из которой запускается программа, создаётся файл с итоговыми данными по расходу топлива [год.месяц] Расчет фактического расхода топлива по машинам.xlsx

6. Для консультаций по работе программы, или при необходимости внести доработки в программу необходимо написать письмо разработчику по электронному адресу 7034@balancedv.ru
